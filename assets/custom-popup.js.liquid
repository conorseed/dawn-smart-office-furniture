document.addEventListener('DOMContentLoaded', ()=>{
  const newsletter__modal = document.getElementById("customNewsletter");

  const newsletter__close = document.getElementById("customNewsletter__close");
  
  newsletter__close.addEventListener("click", () => {
    Cookies.set('popUpVisited', 'true', { expires: 1 });
    newsletter__modal.style.display = "none";
  });
  
  // do not show if cookie, or shopify challenge page
  const cookieStatus = Cookies.get('popUpVisited');
  const challenge = window.location.href.indexOf("challenge?form_key") > -1
  if (cookieStatus || challenge) return;

  // add email error manually if already subscribed
  const alreadyCustomer = window.location.href.indexOf("?contact%5Btags%5D=newsletter") > -1
  if(alreadyCustomer){
    const errorMessage = document.createElement('p');
    errorMessage.classList.add('newsletter-form__message');
    errorMessage.classList.add('form__message');
    errorMessage.textContent = 'This email address may already be subscribed. Please try again with a different email address.';
    newsletter__modal.querySelector('.field').after(errorMessage);
  }
  
  const popUpForm = document.getElementById('customNewsletter');
  popUpForm.style.display = "flex";
})